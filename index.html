<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Restaudit Dashboard</title>
    <link rel="stylesheet" href="style.css">
</head>
<body onload="updateDateTime()">
    <header>
        <div class="HeaderCenter">
            <div class="new-closed">
                <span id="Time"></span>
                <div class="new">156<br>Новые</div>
            </div>
            <div class="logo">
                <img src="Logo.png" class="logoimg" alt="">
            </div>
            <div class="new-closed">
                <div class="closed">200<br>Закрытые</div>
                <span id="DataTime"></span>
            </div>
        </div>
    </header>
        
    <div class="content">
        <div class="columns-1">
            
            
            <div class="weather">
                <img id="weatherImage" alt="weather">
                <div class="weather-info">
                    <img id="weatherImages" alt="weather">
                    <p>г. <span id="City"></span></p> 
                    <p>Температура: <span id="AirTemp"></span> °C</p> 
                    
                    <p id="WindSpeed">Ветер: </p> 
                    <p id="CityError"></p> 
                </div>
            </div>


            <div class="requests">
                <h2>Заявки, обрати внимание!</h2>
                <table>
                    <thead>
                        <tr>
                            <th>Заявка клиента</th>
                            <th>Статус</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>id12324 Брют Советская</td>
                            <td>Новая</td>
                        </tr>
                    </tbody>
                    
                </table>
            </div>

            <div class="visits">
                <h2>Выезды</h2>
                <table>
                    <thead>
                        <tr>
                            <th>Клиент</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Брют Советская</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="stats">
                <h2>Статистика</h2>
                <table>
                    <thead>
                        <tr>
                            <th>Статус</th>
                            <th>Кол-во</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>В работе</td>
                            <td>34</td>
                        </tr>
                        
                    </tbody>
                </table>
            </div>
        </div>
        
        <div class="columns-2">
            <div class="calls">
                <h2>Звонки из АТС</h2>
                <table>
                    <thead>
                        <tr>
                            <th>Номер</th>
                            <th>Время</th>
                            <th>Статус</th>
                            <th>ФИО</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>+79292002177</td>
                            <td>15:30</td>
                            <td>Принят</td>
                            <td>Петросян Араик</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        
            <div class="rating">
                <h2>Рейтинг сотрудников</h2>
                <table>
                    <thead>
                        <tr>
                            <th>ФИО</th>
                            <th>Новые</th>
                            <th>Завершено</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Иванов Иван</td>
                            <td>18</td>
                            <td>50</td>
                        </tr>
                        
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <script >
window.onload = function() {
    myWeater();
    updateWeatherImage(); // Обновляем изображение при загрузке
};

// Устанавливаем интервал обновления погоды каждые 10 минут (600000 мс)
setInterval(myWeater, 600000);

function myWeater() {
    const city = 'Тюмень'; // Установите город по умолчанию
    fetch(`http://api.openweathermap.org/data/2.5/weather?q=${city}&appid=11c0d3dc6093f7442898ee49d2430d20&units=metric`)
        .then(function (resp) {
            if (!resp.ok) {
                throw new Error('Network response was not ok');
            }
            return resp.json();
        })
        .then(function (data) {
            console.log(data);
            if (data.cod === '404') {
                document.querySelector('#CityError').textContent = "Город не найден";
                document.querySelector('#City').textContent = "";
                
                document.querySelector('#WindSpeed').textContent = "";
                document.querySelector('#AirTemp').textContent = "";
            } else {
                document.querySelector('#CityError').textContent = "";
                document.querySelector('#City').textContent = data.name;
                
                document.querySelector('#WindSpeed').textContent = `Ветер: ${data.wind.speed} m/s`;
                document.querySelector('#AirTemp').textContent = data.main.temp;
                document.querySelector('#weatherImages').src = `https://openweathermap.org/img/wn/${data.weather[0]['icon']}@2x.png`;
            }
        })
        .catch(function () {
            console.error("Ошибка при получении данных о погоде");
        });
}

function updateWeatherImage() {
    const hour = new Date().getHours(); // Получаем текущий час
    const weatherImage = document.querySelector('#weatherImage');

    if (hour >= 6 && hour < 18) {
        // Если время от 6:00 до 17:59, используем дневное изображение
        weatherImage.src = 'day.png';  // Замените на путь к вашему дневному изображению
    } else {
        // В противном случае используем ночное изображение
        weatherImage.src = 'night.png'; // Замените на путь к вашему ночному изображению
    }
}


function updateDateTime() {
    // Определяем временную зону Екатеринбурга
    const ekbTimeZone = 'Asia/Yekaterinburg';
    
    // Получаем текущее время в Екатеринбурге
    const currentTime = new Date().toLocaleTimeString('ru-RU', { timeZone: ekbTimeZone });

    // Получаем текущую дату в Екатеринбурге
    const currentDate = new Date().toLocaleDateString('ru-RU', { timeZone: ekbTimeZone });
    
    // Выводим время и дату на страницу
    document.getElementById('Time').textContent = currentTime;
    document.getElementById('DataTime').textContent = currentDate;
}

// Обновляем дату и время каждые 1 секунду
setInterval(updateDateTime, 1000);
</script>
</body>
</html>
